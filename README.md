# Spring 2025 UMass COMPSCI 696DS Homework 1
This assignment is designed to familiarize you with the shared Unity cluster, which is the first step in your journey to a successful project.  
Knowledge of proper usage and etiquette is important for avoiding actions that interfere with other cluster users.

Please carefully read the following instructions and the linked documentation. Happy 696DS!

## Setup
0. You should have obtained your Unity account by now. If not please follow the steps on [this page](https://docs.unity.rc.umass.edu/documentation/getting-access/) listed under "Accounts for Students". Your PI is `pi_wenlongzhao_umass_edu`. 
1. Connect to the Unity GPU cluster: https://docs.unity.rc.umass.edu/documentation/connecting/ssh/.
2. Change to your home directory: `cd ~`. 
This directory, `/home/<username>`, is on a slow HDD and should have 50GB of space. 
It is sufficient for this assignment. 
For your project, we will provide separate guidelines about using workspaces on a fast SSD.
3. Clone this repository and enter it:
    ```
    git clone https://github.com/dhdhagar/696ds-unity-assignment.git
    cd 696ds-unity-assignment
    ```
4. Use `conda` to create an environment for installing relevant packages and libraries for each project. 
Unity already has `conda` installed and you can load it by `module load conda/latest`. 
    More about `conda` can be read here: https://docs.unity.rc.umass.edu/documentation/software/conda/.
5. Create a `conda` environment for this assignment: 
`conda create --name 696hw1 python=3.9.7 pip`. 
You can replace `696hw1` by your preferred environment name.
6. Activate the `conda` environment: `conda activate 696hw1`.
7. Install packages in this environment: `pip install -r requirements.txt`.

## Unity job management
- Unity consists of *login* nodes and *computation* nodes, and uses [SLURM](https://slurm.schedmd.com/documentation.html) to manage GPU allocation and job scheduling. 
  - Always run jobs (model training, testing, etc.) on computation nodes. 
  **Never run a JOB on a login node!!! This may prevent others from even logging in.**
- There are, in general, two ways to access GPUs: 
  1. Request an interactive session with GPU access. 
  You will be sent to a computation node and will be able to run bash and python scripts. 
  Once you close your terminal, the GPU access is lost. This is suitable for debugging. 
  2. Submit `sbatch` jobs to run in the background.
  Even if you close your terminal, the job will continue till it is complete. 
  This is suitable for submitting multiple training or evaluation runs that will last for several hours.
- Please read more details here: https://docs.unity.rc.umass.edu/documentation/jobs/. 
The linked webpage also has sub-pages.

## Exercise
1. Obtain an interactive session with GPU access and run `test/generate_id.py`:
    ```
    srun --partition gpu --gres=gpu:1 -c 2 --mem=20GB -t 0-01:00:00 --pty /bin/bash
    ```
    followed by
   ```
    module load conda/latest
    conda activate 696hw1
    python test/generate_id.py
    ``` 
    **Note down the 5 character unique ID generated.** This ID is unique for every student.
2. Activate the conda environment and submit `test/generate_id.py` as an `sbatch` job to be run in the background. You may use `sbatch generate_id.sh` to do so. 
**Note down the 5 character unique ID generated by this job in the log file `generate_id-<job_ID>.out`.** Learn more about commonly used batch job commands here: https://docs.unity.rc.umass.edu/documentation/jobs/sbatch/.
3. Paste the two unique IDs in the assignment on Gradescope.

# Extra information
You can add commands into `~/.bashrc` so that they will automatically run when you `ssh` into a node on Unity.
    ```
    vim ~/.bashrc
    
    # Add this line to avoid manually loading conda.
    module load conda/latest
   
    # Add this line to avoid typing a long name.
    # Instead of cd ~/696ds-unity-assignment, 
    # you will be able to just type cd $hw1.
    export hw1=~/696ds-unity-assignment
    
    # Make the above changes effective.
    source ~/.bashrc
    ```
